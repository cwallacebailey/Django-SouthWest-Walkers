{% extends 'structure/base.html' %}
{{ post.post_title }}
{% block title  %}
{{ post.post_title }}
{% endblock %}

{% block content %}

    <h1>{{ post.post_title }}</h1>
    <div>
        By {{ post.post_author }} | {{ post.created_date }}
        <hr>
        <!-- the safe tag marks the item as safe so the body can be edited into paragraphs -->
        {{ post.body | safe }} 
    </div>
    <br>

    {% if post.post_author.id == user.id %}

    <a href="{% url 'update_post' post.pk %}" class="btn btn-secondary">Update</a> 
    <a href="{% url 'delete_post' post.pk %}" class="btn btn-secondary">Delete</a>
    <br>
    <br>
    <a href="{% url 'home' %} " class="btn btn-secondary">Home</a>

    {% else %}

    <a href="{% url 'home' %} " class="btn btn-secondary">Home</a>

    {% endif %}

    <br><br>
    
    {% if user.is_authenticated %}

    <form action="{% url 'star_post' post.pk %}" method="POST">
        {% csrf_token %}
        {% if post.starred %}
            <button type="submit" name="post_id" value="{{ post.id }}"><i class="fas fa-star"></i></button> - {{ post.total_stars }} star
        {% else %}
            <button type="submit" name="post_id" value="{{ post.id }}"><i class="far fa-star"></i></button> - {{ post.total_stars }} star
        {% endif %}
    </form>

    <hr>
    <br>
    <h2>Comments:</h2>
        <h4>Leave a comment</h4>
        <form method="post">
            {{ comment_form }}
            {% csrf_token %}
            <br>
            <button type="submit" class="btn btn-secondary">Post Comment</button>
        </form>
        <hr>
        <br>
        {% for comment in comments %}
        {{ comment.comment_author }} : {{ comment.created_date }}
        <br>
        {{ comment.body }}
        <br>
        <hr>
        {% endfor %}

    {% else %}

        <button type="submit", name="post_id", value="{{ post.id }}"><i class="far fa-star"></i></button> - {{ post.total_stars }} Stars

    {% endif %}

{% endblock %}